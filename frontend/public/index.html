<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blood Bridge | Emergency Blood Network</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/animations.css">
    <!-- Leaflet Map CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <!-- Leaflet Map JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <style>
        /* CRITICAL INLINE STYLES FOR PREMIUM UI */
        .glass-card-premium {
            background: rgba(15, 23, 42, 0.6) !important;
            backdrop-filter: blur(16px) !important;
            -webkit-backdrop-filter: blur(16px) !important;
            border: 1px solid rgba(255, 255, 255, 0.08) !important;
            border-radius: 24px !important;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3) !important;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
            padding: 24px !important;
            position: relative !important;
            overflow: hidden !important;
        }

        .glass-card-premium:hover {
            background: rgba(15, 23, 42, 0.8) !important;
            border-color: rgba(255, 255, 255, 0.2) !important;
            transform: translateY(-4px) !important;
            box-shadow: 0 12px 40px rgba(225, 29, 72, 0.15) !important; 
        }

        #hero-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }
        
        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(225, 29, 72, 0.7); transform: scale(1); }
            70% { box-shadow: 0 0 0 10px rgba(225, 29, 72, 0); transform: scale(1.02); }
            100% { box-shadow: 0 0 0 0 rgba(225, 29, 72, 0); transform: scale(1); }
        }
        
        @keyframes radar-ping {
            0% { transform: scale(0.95); opacity: 0.5; box-shadow: 0 0 0 0 rgba(225, 29, 72, 0.7); }
            70% { transform: scale(1); opacity: 0.8; box-shadow: 0 0 0 20px rgba(225, 29, 72, 0); }
            100% { transform: scale(0.95); opacity: 0.5; box-shadow: 0 0 0 0 rgba(225, 29, 72, 0); }
        }

        @keyframes text-shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }
    </style>
</head>

<body>
    <!-- ... body content ... -->
    <script src="js/api.js?v=4.0"></script>
    <script src="js/auth.js?v=7.0"></script>
    <script src="js/app.js?v=7.0"></script>
    <!-- Inline Particle Script -->
    <script>
        // Force Run Particles
        window.addEventListener('load', () => {
            console.log("Force Loaded Particles");
            const canvas = document.getElementById('hero-particles');
            if (canvas) {
                const ctx = canvas.getContext('2d');
                let width, height;
                let particles = [];
                const resize = () => {
                    width = canvas.width = canvas.parentElement.offsetWidth;
                    height = canvas.height = canvas.parentElement.offsetHeight;
                };
                window.addEventListener('resize', resize);
                resize();
                class Particle {
                    constructor() {
                        this.x = Math.random() * width;
                        this.y = Math.random() * height;
                        this.vx = (Math.random() - 0.5) * 0.5;
                        this.vy = (Math.random() - 0.5) * 0.5;
                        this.size = Math.random() * 2 + 1;
                        this.color = Math.random() > 0.8 ? '#E11D48' : '#334155';
                    }
                    update() {
                        this.x += this.vx;
                        this.y += this.vy;
                        if (this.x < 0 || this.x > width) this.vx *= -1;
                        if (this.y < 0 || this.y > height) this.vy *= -1;
                    }
                    draw() {
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                        ctx.fillStyle = this.color;
                        ctx.fill();
                    }
                }
                for (let i = 0; i < 50; i++) particles.push(new Particle());
                const animate = () => {
                    ctx.clearRect(0, 0, width, height);
                    particles.forEach((p, index) => {
                        p.update();
                        p.draw();
                        for (let j = index + 1; j < particles.length; j++) {
                            const p2 = particles[j];
                            const dx = p.x - p2.x;
                            const dy = p.y - p2.y;
                            const dist = Math.sqrt(dx*dx + dy*dy);
                            if (dist < 150) {
                                ctx.beginPath();
                                ctx.strokeStyle = `rgba(148, 163, 184, ${0.1 - dist/1500})`;
                                ctx.lineWidth = 1;
                                ctx.moveTo(p.x, p.y);
                                ctx.lineTo(p2.x, p2.y);
                                ctx.stroke();
                            }
                        }
                    });
                    requestAnimationFrame(animate);
                };
                animate();
            }
        });
    </script>
</body>
</head>

<body>

    <!-- Global Notification Toast -->
    <div id="notification" style="position: fixed; bottom: 30px; right: 30px; z-index: 2000;"></div>

    <!-- Navigation (Floating Glass Pill) -->
    <nav class="navbar">
        <div class="logo">
            <div
                style="width: 40px; height: 40px; position: relative; display: flex; align-items: center; justify-content: center;">
                <div style="position: absolute; width: 100%; height: 100%; background: var(--primary-main); opacity: 0.2; border-radius: 50%; filter: blur(8px);"></div>
                <div style="width: 36px; height: 36px; background: linear-gradient(135deg, var(--primary-main), #be123c); border-radius: 10px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(225, 29, 72, 0.4); transform: rotate(45deg);">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" style="transform: rotate(-45deg);">
                        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        <path d="M12 7v5" stroke-linecap="round"/>
                        <path d="M9.5 9.5h5" stroke-linecap="round"/>
                    </svg>
                </div>
            </div>
            <span
                style="font-weight: 800; font-size: 1.25rem; margin-left: 12px; letter-spacing: -0.02em;">BloodBridge</span>
        </div>

        <div class="mobile-toggle" onclick="toggleMobileMenu()">
            ‚ò∞
        </div>

        <div class="nav-links" id="nav-links-container">
            <button onclick="showPage('home')" class="nav-item active" id="nav-home">Home</button>
            <button onclick="showPage('emergency')" class="nav-item" id="nav-emergency">Find Blood</button>
            <button onclick="showPage('hospital-dashboard')" class="nav-item" id="nav-hospital-dashboard">Institutions</button>
        </div>

        <div class="nav-actions" style="display: flex; gap: 12px; align-items: center;">
            <!-- Auth / User -->
            <div id="auth-buttons" style="display: flex; gap: 12px;">
                <button onclick="showPage('login')" class="btn btn-secondary" style="padding: 10px 20px;">Log In</button>
                <button onclick="showPage('register')" class="btn btn-primary" style="padding: 10px 24px;">Join Now</button>
            </div>

            <div id="user-info" class="hidden dropdown-container">
                <!-- Injected via JS -->
            </div>
        </div>
    </nav>

    <!-- CONTENT -->
    <main class="container">

        <!-- HOME PAGE -->
        <section id="home" class="page active" style="padding-top: 120px;">
            <canvas id="hero-particles" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none;"></canvas>
            <div class="hero-glow"></div>
            
            <div class="hero-split" style="position: relative; z-index: 1;">
                <div class="hero-content">
                    <div class="badge badge-brand" style="margin-bottom: 24px;">üî¥ Emergency Response Network v2.0</div>
                    <h1 style="font-size: 4rem; margin-bottom: 24px;">Every Second Counts. <span class="text-gradient">Save a Life Today.</span></h1>
                    <p style="font-size: 1.25rem; margin-bottom: 40px; line-height: 1.8; color: var(--text-body);">
                        The intelligent platform bridging hospitals directly with nearby verified donors. 
                        No middlemen. Zero delays. 100% transparent impact.
                    </p>
                    
                    <div style="display: flex; gap: 16px; flex-wrap: wrap;">
                        <button onclick="showPage('register')" class="btn btn-primary" style="height: 56px; padding: 0 40px; font-size: 1.1rem; border-radius: 16px;">
                            üåç Join as Donor
                        </button>
                        <button onclick="showPage('emergency')" class="btn btn-secondary" style="height: 56px; padding: 0 32px; font-size: 1.1rem; border-radius: 16px;">
                            üöë Find Blood
                        </button>
                    </div>

                    <!-- Dynamic Stats Bar -->
                    <div style="margin-top: 80px; padding: 24px; background: rgba(15, 23, 42, 0.4); border: 1px solid var(--border-subtle); border-radius: 20px; display: inline-flex; gap: 48px; backdrop-filter: blur(8px);">
                        <div style="text-align: center;">
                            <div class="font-bold text-gradient" style="font-size: 2.5rem;" id="stat-donors">2,450+</div>
                            <div class="text-xs uppercase tracking-widest text-secondary" style="font-weight: 700;">Heroes Registered</div>
                        </div>
                        <div style="width: 1px; background: var(--border-subtle);"></div>
                        <div style="text-align: center;">
                            <div class="font-bold" style="font-size: 2.5rem; color: var(--danger-text);" id="stat-alerts">12</div>
                            <div class="text-xs uppercase tracking-widest text-secondary" style="font-weight: 700;">Active Alerts</div>
                        </div>
                         <div style="width: 1px; background: var(--border-subtle);"></div>
                        <div style="text-align: center;">
                            <div class="font-bold text-gradient" style="font-size: 2.5rem;">< 5m</div>
                            <div class="text-xs uppercase tracking-widest text-secondary" style="font-weight: 700;">Avg Response</div>
                        </div>
                    </div>
                </div>

                <div class="hero-visual" style="position: relative;">
                     <!-- Abstract UI Representation -->
                     <div style="position: relative; z-index: 1;">
                        <div class="glass-card-premium" style="position: absolute; top: 0; right: 0; width: 280px; transform: rotate(-6deg); z-index: 2; border: 1px solid var(--border-highlight); background: #0f172a;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <div class="badge" style="background: #FEF2F2; color: #DC2626;">SOS: A+ NEGATIVE</div>
                                <span style="font-size: 0.8rem; color: var(--text-secondary);">Now</span>
                            </div>
                            <h4 style="margin-bottom: 8px;">City General Hospital</h4>
                            <div style="height: 6px; background: #334155; border-radius: 4px; overflow: hidden; margin-top: 12px;">
                                <div style="width: 70%; height: 100%; background: var(--danger-base);"></div>
                            </div>
                        </div>

                        <div class="glass-card-premium" style="width: 320px; margin-top: 60px; margin-left: 40px; border: 1px solid var(--border-highlight); background: #1e293b; box-shadow: 0 20px 50px rgba(0,0,0,0.5);">
                            <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px;">
                                <div style="width: 48px; height: 48px; background: var(--success-bg); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">ü¶∏‚Äç‚ôÇÔ∏è</div>
                                <div>
                                    <div style="font-weight: 700;">Sarah Jenkins</div>
                                    <div style="font-size: 0.85rem; color: var(--success-text);">On the way ‚Ä¢ 2km</div>
                                </div>
                            </div>
                            <button class="btn btn-primary" style="width: 100%; font-size: 0.9rem;">Map View</button>
                        </div>
                     </div>
                     <!-- Glow behind visual -->
                     <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 400px; height: 400px; background: var(--primary-main); opacity: 0.15; filter: blur(80px); border-radius: 50%;"></div>
                </div>
            </div>

            <!-- FEATURES / HOW IT WORKS -->
            <div class="features-section">
                <div style="text-align: center; margin-bottom: 64px;">
                    <h2 style="font-size: 3rem; margin-bottom: 16px;">How BloodBridge Works</h2>
                    <p style="margin: 0 auto; font-size: 1.2rem;">A seamless ecosystem designed for speed, trust, and saving lives.</p>
                </div>

                <div class="grid-features">
                    <!-- Step 1 -->
                    <div class="feature-card">
                        <div class="step-number">01</div>
                        <div class="feature-icon">üè•</div>
                        <h3>Hospital Request</h3>
                        <p style="margin-top: 16px;">Institutions broadcast urgent blood requirements with specific blood group, location, and urgency level.</p>
                    </div>

                    <!-- Step 2 -->
                    <div class="feature-card">
                        <div class="step-number">02</div>
                        <div class="feature-icon">üì°</div>
                        <h3>Smart Notification</h3>
                        <p style="margin-top: 16px;">Our algorithm instantly alerts nearby verified donors matching the blood type via SMS and App notifications.</p>
                    </div>

                     <!-- Step 3 -->
                     <div class="feature-card">
                        <div class="step-number">03</div>
                        <div class="feature-icon">‚ù§Ô∏è</div>
                        <h3>Life Saved</h3>
                        <p style="margin-top: 16px;">Donors accept the request, navigate to the hospital, and complete the donation. Lives impacted +1.</p>
                    </div>
                </div>
            </div>
        </section>
                        <!-- Dynamic Live Status Container -->
                        <!-- <div id="hero-live-status" style="position: relative; width: 320px; z-index: 5; margin-left: -40px; margin-top: 40px;">
                           
                            <div class="glass-card-premium" style="opacity: 0.8;">
                                <div style="display: flex; gap: 16px; align-items: center; margin-bottom: 24px;">
                                    <div class="skeleton" style="width: 56px; height: 56px; border-radius: 50%;"></div>
                                    <div style="flex: 1;">
                                        <div class="skeleton" style="height: 20px; width: 80%; margin-bottom: 8px; border-radius: 4px;"></div>
                                        <div class="skeleton" style="height: 14px; width: 50%; border-radius: 4px;"></div>
                                    </div>
                                </div>
                                <div class="skeleton" style="height: 80px; width: 100%; border-radius: 12px; margin-bottom: 24px;"></div>
                                <div class="skeleton" style="height: 56px; width: 100%; border-radius: 12px;"></div>
                            </div> -->
                        </div>
                    </div>
                </div>

                <div class="grid-features" style="margin-top: 96px;">
                    <div class="glass-card-premium">
                        <div
                            style="width: 40px; height: 40px; background: var(--primary-50); border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 16px;">
                            ‚ù§Ô∏è</div>
                        <h3>For Donors</h3>
                        <p style="font-size: 0.95rem; margin-top: 8px;">Receive instant alerts when your blood type is
                            needed nearby. Track your donations and impact.</p>
                    </div>
                    <div class="glass-card-premium">
                        <div
                            style="width: 40px; height: 40px; background: var(--info-base); opacity: 0.1; border-radius: 8px; position: absolute;">
                        </div>
                        <div
                            style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-bottom: 16px; color: var(--info-base);">
                            üè•</div>
                        <h3>For Hospitals</h3>
                        <p style="font-size: 0.95rem; margin-top: 8px;">Broadcast requests with geolocation. Manage
                            inventory and track response times in real-time.</p>
                    </div>
                    <div class="glass-card-premium">
                        <div
                            style="width: 40px; height: 40px; background: var(--warning-base); opacity: 0.1; border-radius: 8px; position: absolute;">
                        </div>
                        <div
                            style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-bottom: 16px; color: var(--warning-base);">
                            ‚ö°</div>
                        <h3>Speed Matters</h3>
                        <p style="font-size: 0.95rem; margin-top: 8px;">Our algorithm ensures the closest donors are
                            notified first, reducing transport time significantly.</p>
                    </div>
                </div>
        </section>

        <!-- AUTH: LOGIN -->
        <section id="login" class="page">
            <div style="max-width: 400px; margin: 40px auto;">
                <h2 style="text-align: center; margin-bottom: 32px;">Welcome back</h2>
                <div class="glass-card-premium">
                    <form id="login-form">
                        <div class="form-group">
                            <label class="label">Email Address</label>
                            <input type="email" id="login-email" class="input" placeholder="you@example.com" required>
                        </div>
                        <div class="form-group">
                            <label class="label">Password</label>
                            <input type="password" id="login-password" class="input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6">
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 8px;">Sign
                            In</button>
                    </form>
                </div>
                <p style="text-align: center; margin-top: 24px; font-size: 0.9rem;">
                    Don't have an account? <a href="#" onclick="showPage('register')"
                        style="color: var(--action-brand); font-weight: 600; text-decoration: none;">Create one</a>
                </p>
            </div>
        </section>

        <!-- AUTH: REGISTER -->
        <section id="register" class="page">
            <div style="max-width: 480px; margin: 40px auto;">
                <h2 style="text-align: center; margin-bottom: 32px;">Join the Network</h2>
                <div class="glass-card-premium">
                    <form id="register-form">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <div class="form-group">
                                <label class="label">Full Name</label>
                                <input type="text" id="reg-name" class="input" required>
                            </div>
                            <div class="form-group">
                                <label class="label">City</label>
                                <input type="text" id="reg-city" class="input" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="label">Email Address</label>
                            <input type="email" id="reg-email" class="input" required>
                        </div>

                        <div class="form-group">
                            <label class="label">Password</label>
                            <input type="password" id="reg-password" class="input" required minlength="6">
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <div class="form-group">
                                <label class="label">Role</label>
                                <select id="reg-role" class="input">
                                    <option value="donor">Donor</option>
                                    <option value="hospital">Hospital</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="label">Blood Group</label>
                                <select id="reg-blood" class="input">
                                    <option value="A+">A+</option>
                                    <option value="O+">O+</option>
                                    <option value="B+">B+</option>
                                    <option value="AB+">AB+</option>
                                    <option value="A-">A-</option>
                                    <option value="O-">O-</option>
                                    <option value="B-">B-</option>
                                    <option value="AB-">AB-</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="label">Phone Number</label>
                            <input type="tel" id="reg-phone" class="input" required>
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 8px;">Create
                            Account</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- DASHBOARD: DONOR -->
        <section id="donor-dashboard" class="page">
            <div class="dashboard-layout">
                <aside class="sidebar">
                    <div
                        style="padding: 0 12px; margin-bottom: 12px; font-size: 0.75rem; color: var(--text-tertiary); font-weight: 700; text-transform: uppercase;">
                        Menu</div>
                    <div class="sidebar-item active">Overview</div>
                    <div class="sidebar-item">My Donations</div>
                    <div class="sidebar-item">Achievements</div>
                    <div class="sidebar-item">Profile Settings</div>
                </aside>

                <div class="content">
                    <div style="margin-bottom: 32px;">
                        <h2>Welcome back, <span id="dash-user-name">User</span></h2>
                        <p>Thank you for being a lifesaver. Here is your impact overview.</p>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 24px; margin-bottom: 48px;"
                        id="donor-stats">
                        <!-- Stats injected via JS -->
                    </div>

                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                        <h3>Active Emergency Requests</h3>
                        <div class="text-sm text-secondary">Within 25km radius</div>
                    </div>

                    <div id="emergency-requests-donor" style="display: grid; gap: 16px;">
                        <!-- Requests injected via JS -->
                    </div>
                </div>
            </div>
        </section>

        <!-- EMERGENCY PAGE (WIZARD) -->
        <section id="emergency" class="page">
            <div style="max-width: 640px; margin: 0 auto;">
                <div style="text-align: center; margin-bottom: 40px;">
                    <h2>Broadcast Emergency SOS</h2>
                    <p>Alert all verified donors in the vicinity immediately.</p>
                </div>

                <div class="glass-card-premium">
                <div class="glass-card-premium" style="position: relative; overflow: hidden;">
                    <!-- Stepper Header -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; position: relative; padding: 0 16px;">
                        <!-- Progress Line Background -->
                        <div style="position: absolute; top: 18px; left: 40px; right: 40px; height: 2px; background: rgba(255,255,255,0.1); z-index: 0;"></div>
                        <!-- Progress Line Active -->
                        <div id="wizard-progress" style="position: absolute; top: 18px; left: 40px; width: 0%; height: 2px; background: var(--primary-main); z-index: 0; transition: width 0.5s ease;"></div>

                        <!-- Step 1 Indicator -->
                        <div class="step-indicator active" id="step-ind-1" style="position: relative; z-index: 1;">
                            <div class="step-circle">1</div>
                            <div class="step-label">Patient</div>
                        </div>
                        <!-- Step 2 Indicator -->
                        <div class="step-indicator" id="step-ind-2" style="position: relative; z-index: 1;">
                            <div class="step-circle">2</div>
                            <div class="step-label">Urgency</div>
                        </div>
                        <!-- Step 3 Indicator -->
                        <div class="step-indicator" id="step-ind-3" style="position: relative; z-index: 1;">
                            <div class="step-circle">3</div>
                            <div class="step-label">Review</div>
                        </div>
                    </div>

                    <div class="wizard-container" style="min-height: 480px;">
                        <!-- Step 1 -->
                        <div id="step-1" class="wizard-step active">
                            <div style="margin-bottom: 32px; text-align: center;">
                                <h3>Who needs help?</h3>
                                <p style="font-size: 0.9rem; margin: 0 auto;">Patient details are encrypted and shared only with verified donors.</p>
                            </div>

                            <div class="form-group floating-label">
                                <input type="text" id="emg-name" class="input" placeholder=" " required>
                                <label class="label">Patient Full Name</label>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <div class="form-group">
                                    <label class="label" style="margin-bottom: 8px; display: block;">Blood Group</label>
                                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;">
                                        <button class="blood-selector active" onclick="selectBlood(this, 'O+')">O+</button>
                                        <button class="blood-selector" onclick="selectBlood(this, 'A+')">A+</button>
                                        <button class="blood-selector" onclick="selectBlood(this, 'B+')">B+</button>
                                        <button class="blood-selector" onclick="selectBlood(this, 'AB+')">AB+</button>
                                    </div>
                                    <input type="hidden" id="emg-blood" value="O+">
                                </div>
                                <div class="form-group floating-label">
                                    <input type="number" id="emg-units" class="input" placeholder=" " value="1" min="1" max="10">
                                    <label class="label">Units Required</label>
                                </div>
                            </div>

                            <div class="form-group floating-label">
                                <input type="text" id="emg-condition" class="input" placeholder=" " required>
                                <label class="label">Medical Condition (e.g. Surgery)</label>
                            </div>

                            <div style="margin-top: 40px;">
                                <button onclick="nextStep(2)" class="btn btn-primary" style="width: 100%; height: 50px; font-size: 1.1rem;">Continue to Location</button>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div id="step-2" class="wizard-step">
                             <div style="margin-bottom: 32px; text-align: center;">
                                <h3>Location & Urgency</h3>
                                <p style="font-size: 0.9rem; margin: 0 auto;">This determines the radius and speed of the broadcast.</p>
                            </div>

                            <div class="form-group" style="margin-bottom: 32px;">
                                <label class="label" style="display: block; margin-bottom: 12px;">Urgency Level</label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                                    <div class="urgency-option" onclick="selectUrgency(this, 'severe')">
                                        <span style="font-size: 1.5rem;">üü°</span>
                                        <span style="font-weight: 700; font-size: 0.9rem;">Severe</span>
                                        <span style="font-size: 0.7rem; opacity: 0.7;">< 24 hrs</span>
                                    </div>
                                    <div class="urgency-option" onclick="selectUrgency(this, 'urgent')">
                                        <span style="font-size: 1.5rem;">üü†</span>
                                        <span style="font-weight: 700; font-size: 0.9rem;">Urgent</span>
                                        <span style="font-size: 0.7rem; opacity: 0.7;">< 4 hrs</span>
                                    </div>
                                    <div class="urgency-option active" onclick="selectUrgency(this, 'critical')">
                                        <span style="font-size: 1.5rem;">üî¥</span>
                                        <span style="font-weight: 700; font-size: 0.9rem;">Critical</span>
                                        <span style="font-size: 0.7rem; opacity: 0.7;">Immediate</span>
                                    </div>
                                </div>
                                <input type="hidden" id="emg-urgency" value="critical">
                                <div id="urgency-display" style="margin-top: 16px; font-size: 0.85rem; padding: 12px; background: rgba(220, 38, 38, 0.1); border: 1px solid rgba(220, 38, 38, 0.2); border-radius: 8px; color: #F87171; text-align: center;">
                                    network: <strong>Critical Priority</strong>. 150+ donors within 10km will be alerted instantly.
                                </div>
                            </div>

                            <div class="form-group floating-label">
                                <input type="text" id="emg-location" class="input" placeholder=" " required>
                                <label class="label">Hospital/Center Name</label>
                            </div>

                            <div class="form-group floating-label">
                                <input type="tel" id="emg-contact-phone" class="input" placeholder=" " required>
                                <label class="label">Contact Number</label>
                            </div>

                             <!-- Hidden fields -->
                            <input type="hidden" id="emg-landmark" value="Main Entrance">
                            <input type="hidden" id="emg-contact-name" value="Hospital Staff">

                            <div style="display: flex; gap: 16px; margin-top: 40px;">
                                <button onclick="prevStep(1)" class="btn btn-secondary" style="flex: 1">Back</button>
                                <button onclick="nextStep(3)" class="btn btn-primary" style="flex: 1">Review</button>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div id="step-3" class="wizard-step">
                             <div style="margin-bottom: 32px; text-align: center;">
                                <div style="width: 80px; height: 80px; background: rgba(225, 29, 72, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px;">
                                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" class="anim-pulse">
                                         <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4C16.42 4 20 7.58 20 12C20 16.42 16.42 20 12 20Z" fill="#E11D48" opacity="0.3"/>
                                         <path d="M12 17L10.55 15.68C5.4 11.01 2 7.93 2 4.15C2 1.07 4.42 -1.35 7.5 -1.35C9.24 -1.35 10.91 -0.54 12 0.73C13.09 -0.54 14.76 -1.35 16.5 -1.35C19.58 -1.35 22 1.07 22 4.15C22 7.93 18.6 11.01 13.45 15.68L12 17Z" transform="translate(0, 5) scale(0.6)" fill="#E11D48"/>
                                    </svg>
                                </div>
                                <h3 style="margin-bottom: 8px;">Confirm Broadcast</h3>
                                <p style="font-size: 0.9rem; margin: 0 auto;">Alerts will be sent immediately to nearby donors.</p>
                            </div>

                            <div style="background: rgba(255,255,255,0.03); border-radius: 16px; padding: 24px; border: 1px solid rgba(255,255,255,0.05);">
                                <div class="summary-row" style="display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 0.95rem;">
                                    <span style="color: var(--text-secondary);">Patient</span>
                                    <span style="font-weight: 600;" id="summary-name">-</span>
                                </div>
                                <div class="summary-row" style="display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 0.95rem;">
                                    <span style="color: var(--text-secondary);">Requirement</span>
                                    <span style="font-weight: 600;"><span id="summary-units">-</span> Units of <span id="summary-blood" style="color: var(--danger-text);">-</span></span>
                                </div>
                                <div class="summary-row" style="display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 0.95rem;">
                                    <span style="color: var(--text-secondary);">Location</span>
                                    <span style="font-weight: 600;" id="summary-location">-</span>
                                </div>
                                <div class="summary-row" style="display: flex; justify-content: space-between; font-size: 0.95rem;">
                                    <span style="color: var(--text-secondary);">Priority</span>
                                    <span style="font-weight: 700; color: #F87171;" id="summary-urgency">CRITICAL</span>
                                </div>
                            </div>

                            <div style="display: flex; gap: 16px; margin-top: 40px;">
                                <button onclick="prevStep(2)" class="btn btn-secondary" style="flex: 1">Back</button>
                                <button onclick="submitEmergency()" id="btn-broadcast" class="btn btn-primary" style="flex: 2; font-weight: 800; letter-spacing: 0.05em; background: var(--danger-base); border-color: var(--danger-base);">
                                    üö® SEND ALERT
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Custom Styles for Wizard -->
                <style>
                    .step-indicator {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        gap: 8px;
                        opacity: 0.5;
                        transition: all 0.3s;
                    }
                    .step-indicator.active {
                        opacity: 1;
                        transform: scale(1.1);
                    }
                    .step-circle {
                        width: 32px;
                        height: 32px;
                        border-radius: 50%;
                        background: var(--bg-surface);
                        border: 2px solid var(--text-muted);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-weight: 700;
                        font-size: 0.9rem;
                        transition: all 0.3s;
                    }
                    .step-indicator.active .step-circle {
                        background: var(--primary-main);
                        border-color: var(--primary-main);
                        box-shadow: 0 0 15px rgba(225, 29, 72, 0.4);
                    }
                     .step-label {
                        font-size: 0.75rem;
                        font-weight: 600;
                        text-transform: uppercase;
                        letter-spacing: 0.05em;
                    }
                    
                    /* Blood Selector */
                    .blood-selector {
                        padding: 10px;
                        background: rgba(255,255,255,0.03);
                        border: 1px solid var(--border-subtle);
                        border-radius: 8px;
                        color: var(--text-body);
                        font-weight: 700;
                        cursor: pointer;
                        transition: all 0.2s;
                    }
                    .blood-selector:hover {
                        background: rgba(255,255,255,0.08);
                    }
                    .blood-selector.active {
                        background: var(--danger-base);
                        border-color: var(--danger-base);
                        color: white;
                        box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
                    }

                    /* Urgency Option */
                    .urgency-option {
                        padding: 16px;
                        border: 1px solid var(--border-subtle);
                        border-radius: 12px;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        gap: 6px;
                        cursor: pointer;
                        transition: all 0.2s;
                        background: rgba(255,255,255,0.02);
                    }
                    .urgency-option:hover {
                        border-color: var(--border-highlight);
                        background: rgba(255,255,255,0.05);
                    }
                    .urgency-option.active {
                        border-color: var(--primary-main);
                        background: rgba(225, 29, 72, 0.1);
                        box-shadow: 0 0 20px rgba(225, 29, 72, 0.15);
                    }

                    /* Floating Label */
                    .form-group.floating-label {
                        position: relative;
                        margin-bottom: 24px;
                    }
                    .form-group.floating-label .input {
                        padding: 16px;
                        padding-top: 24px;
                        height: 64px;
                        border: 1px solid var(--border-subtle);
                        background: rgba(2, 6, 23, 0.5);
                    }
                    .form-group.floating-label .input:focus,
                    .form-group.floating-label .input:not(:placeholder-shown) {
                       border-color: var(--primary-main);
                    }
                    .form-group.floating-label .label {
                        position: absolute;
                        top: 22px;
                        left: 16px;
                        font-size: 1rem;
                        color: var(--text-muted);
                        pointer-events: none;
                        transition: all 0.2s ease;
                        margin: 0;
                    }
                    .form-group.floating-label .input:focus + .label,
                    .form-group.floating-label .input:not(:placeholder-shown) + .label {
                        top: 8px;
                        font-size: 0.75rem;
                        color: var(--primary-glow);
                        font-weight: 700;
                    }
                </style>
                </div>
            </div>

            <div id="emergency-list-view" class="container" style="margin-top: 64px;"></div>
        </section>

        <!-- HOSPITAL DASHBOARD -->
        <section id="hospital-dashboard" class="page">
            <div class="dashboard-layout">
                <aside class="sidebar">
                    <div
                        style="padding: 0 12px; margin-bottom: 12px; font-size: 0.75rem; color: var(--text-tertiary); font-weight: 700; text-transform: uppercase;">
                        Hospital Menu</div>
                    <div class="sidebar-item active">Overview</div>
                    <div class="sidebar-item">Active Requests</div>
                    <div class="sidebar-item">Inventory</div>
                    <div class="sidebar-item">Analytics</div>
                </aside>
                <div class="content">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
                        <div>
                            <h2>Hospital Overview</h2>
                            <p>Real-time view of emergency responses.</p>
                        </div>
                        <button onclick="showPage('emergency')" class="btn btn-primary">Create New Request</button>
                    </div>
                    <div id="hospital-stats" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px;">
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <div class="logo" style="margin-bottom: 24px;">
                        <span style="font-weight: 800; font-size: 1.5rem; letter-spacing: -0.02em; color: white;">BloodBridge</span>
                    </div>
                    <p>The world's most advanced emergency blood response network. Connecting humanity through technology and compassion.</p>
                </div>
                <div class="footer-col">
                    <h4>Platform</h4>
                    <a href="#" class="footer-link">Find Blood</a>
                    <a href="#" class="footer-link">For Hospitals</a>
                    <a href="#" class="footer-link">Live Map</a>
                    <a href="#" class="footer-link">Success Stories</a>
                </div>
                <div class="footer-col">
                    <h4>Company</h4>
                    <a href="#" class="footer-link">About Us</a>
                    <a href="#" class="footer-link">Careers</a>
                    <a href="#" class="footer-link">Privacy Policy</a>
                    <a href="#" class="footer-link">Terms of Service</a>
                </div>
                 <div class="footer-col">
                    <h4>Connect</h4>
                    <a href="#" class="footer-link">Twitter</a>
                    <a href="#" class="footer-link">Instagram</a>
                    <a href="#" class="footer-link">LinkedIn</a>
                    <a href="#" class="footer-link">Contact Support</a>
                </div>
            </div>
            <div class="footer-bottom">
                <div>&copy; 2025 Blood Bridge Inc. All rights reserved.</div>
                <div style="display: flex; gap: 24px;">
                    <span>Made with ‚ù§Ô∏è for Humanity</span>
                </div>
            </div>
        </div>
    </footer>

</body>
</html>